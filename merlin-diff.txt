#MERLIN_TARGET="asuswrt-merlin-380.63_2"
#diff -u -r -B -X ./excludes.txt ./${MERLIN_TARGET}-original/ ./${MERLIN_TARGET}/ | grep -v "Only in ./${MERLIN_TARGET}" > merlin-diff.patch

#cd ~/asuswrt-merlin
#ed -s < ~/blackfuel/asuswrt-merlin-tools/asuswrt-merlin-target.patch
#patch --dry-run -p1 -i ~/blackfuel/asuswrt-merlin-tools/380.69-ARM-mods+apps+xtables-addons+nofiles.patch
#patch --dry-run -p1 -i ~/blackfuel/asuswrt-merlin-tools/asuswrt-arm-entropy-backport-3.16.43.patch

#cd ~/asuswrt-merlin.382
#ed -s < ~/blackfuel/asuswrt-merlin-tools/asuswrt-merlin-target.patch
#patch --dry-run -p1 -i ~/blackfuel/asuswrt-merlin-tools/382.2_alpha1-ARM-mods+apps+xtables-addons+nofiles.patch
#patch --dry-run -p1 -i ~/blackfuel/asuswrt-merlin-tools/asuswrt-arm-entropy-backport-3.16.43_382.patch

#---
#cd $HOME/blackfuel
diff -u -B -N -r -x *.rej -x *.orig -x .directory a/Makefile b/Makefile > $HOME/merlin-diff.patch
diff -u -B -N -r -x *.rej -x *.orig -x .directory a/powstatd.c b/powstatd.c >> $HOME/merlin-diff.patch

#---
# strip file times, root folder names and diff comments
sed -r -i 's/^(---) ([^\/ ]*\/){2}(release\/[^ \t]*).*/\1 a\/\3/g;s/^(\+\+\+) ([^\/ ]*\/){2}(release\/[^ \t]*).*/\1 b\/\3/g;s/^diff .*//g' *.patch



